1·主要研究内容及研究方法。
（1）主要研究内容
本项目针对智能网联汽车的受限环境下，遵循 2017 年 NIST 给出轻量级密码设计建议，从轻量级分组密码设计的理论基础和关键技术出发，构造适用于车联网终端的轻量级密码算法，具体研究内容包括：
 研究轻量级分组密码在智能网联汽车中的设计需求。
 研究一种低延迟且适用于车联网节点信息安全通信的轻量级分组密码。
 研究一种对合、高扩散且适用于车联网节点数据安全存储的轻量级分组密码。
 研究设计的轻量级分组密码在车联网节点中的应用。

（2）研究方法
 文献研究法。通过阅读大量轻量级分组密码和智能网联汽车安全相关文献，确保课题的可行性，并了解课题研究的相关背景以及课题研究是否存在一定的现实意义，从文献中获取智能网联汽车面临的安全问题、典型轻量级分组密码的设计案例以及课题相关的最新研究进展。
 对比总结分析法。结合已有的智能网联汽车安全方案，对比分析基于传统分组密码与基于轻量级分组密码的安全方案软硬件实现效率和对存储空间的需求等，以便更好地进行面向智能网联汽车的轻量级分组密码研究与实现。
 实验论证分析法。对现有的以及本课题研究的轻量级分组密码进行仿真实验，测试在 ASIC 硬件平台和 CAN 总线仿真环境下的吞吐率、功耗等性能指标。

2·主要研究成果。特别要说明主要的科学发现和创新之处，并有具体的内容和必要的数据。
（1）针对车联网节点的实时信息交互，本项目设计了一种低延迟的动态轻量级密码 IoVCipher 来保护 CAN 总线数据帧的安全。
车联网将成为未来智能交通系统的重要组成部分，然而，控制器局域网(CAN)协议采用非加密通信。因此，本项目提出了一种轻量级分组密码 IoVCipher，旨在将 CAN 总线系统的安全要求纳入密码设计中。首先，项目组成员为 IoVCipher 设计了一种动态加密结构，通过在 IoVCipher 中引入 CAN ID，在不消耗额外的资源下，使不同数据帧都有唯一的一个加密流程，这有效地防止了一些针对静态结构恢复密钥的攻击。IoVCipher 的整体加密结构如图 1 所示。其次，在.IoVCipher 的组件在设计时考虑到了延迟，因为它是车辆安全的一个关键方面。项目组成员从门级电路构造了一个面积很小、延迟很低的 S 盒，如图 2 所示。与 PRINCE、QARMA、Orthros 等密码所使用的低延迟 Sboxes 相比，它在面积、深度、固定点和完全扩散等指标上表现出色，具体如表 1 所示。此外，为了在解密过程中获得低延迟的子密钥，密钥调度采用密钥交替的方式，能有效抵御滑动攻击。最后，项目组成员提出一种新型了广义 Feistel 结构，使加密电路和解密电路相似。为了使 IoVCipher 达到最佳的扩散效果，提出了一种 RP 置换，可以使加密和解密扩散路径的 DRmax 为 4。

图 1 IoVCipher 密码加密结构图

图 2 IoVCipher 的 S 盒
表 1 不同算法的 S 盒比较
算法 S 盒 面积（GEs） 深度 固定点 完全扩散 对合
Midori () 21.98 3.5 4 No Yes
Midori () 23.33 4 4 Yes Yes
QARMA () 22.33 4 2 No Yes
QARMA () 30.31 4 0 Yes Yes
QARMA () 28.64 4 0 Yes No
PRINCE (S) 24.64 4 0 Yes No
Orthros (S) 21.31 3.5 2 Yes No
IoVCipher (S) 20.32 3.5 0 Yes No

（2）针对车联网节点的存储模块，本项目设计了一种对合且高扩散的 SPN 结构轻量级密码 IVLBC。
对于车联网节点的存储模块，需要考虑在同一电路下尽可能地紧凑地实现数据的加密存储和解密读取。众所周知，高扩散的 SPN 密码在资源极度受限的统一加解密(ED)电路中并不具有优势。针对这一问题已经进行了一些研究，但仍然存在不足。因此，本项目提出了一种基于 SPN 的对合轻量级分组密码 IVLBC。IVLCB 的整体加密结构如图 3 所示。该密码在设计阶段考虑到在资源极度受限的统一 ED 电路中达到紧凑且高扩散。在 IVLCB 设计方面，项目组成员提出了一种基于半字节的对合 P 置换的构造方法，如图 4 所示。该方法可以生成 331776 个对合 P 置换。项目组成员选择一个合适的 P 置换来成为 FP_layer，使明文能最大化地扩散。另外，SKINNY S 盒在逻辑单元实现中是对合的，但在查找表（LUT）实现中不是对合的。项目组设计的 S 盒克服了这个缺点。项目组成员通过对一类 S 盒进行筛选，构造了一个对合、紧凑、小功耗的 S 盒，如表 2 所示。这些对合组件地设计使得 IVLBC 的解密可以在软件和硬件实现中复用加密的代码和电路。

图 3 IVLCB 密码加密结构图

图 4 基于半字节的对合 P 置换的构造方法结构图

表 2 不同 S 盒的硬件性能比较

门级
密码 OR MAOI1 MOAI1 AND NAND NOR 总面积
SKINNY 0 4 0 0 0 4 14.68GE
4 0 4 0 0 0 13.32GE
Piccolo 0 3 1 0 0 4 14.01GE
3 0 4 0 0 1 12.99GE
Midori
(Sb0) 4 0 0 2 9 5 21.98GE
2 0 8 0 0 2 20.66GE
Midori
(Sb1) 2 2 0 1 11 3 23.33GE
1 0 7 2 4 2 23.99GE
LS-Designs 0 4 0 4 0 0 16GE - - - - - - -
NOEKEON 0 7 0 2 0 2 23.35GE
0 0 6 0 4 0 16GE
IVLBC 0 0 4 0 0 4 12GE

(3)为了验证 IoVCipher 密码、IVLBC 密码在车联网中的可行性，本项目基于轮架构对轻量级密码算法进行了硬件电路优化设计以及仿真测试。
IoVCipher 硬件实现的主要目标是实现低延迟，并以最小的开销提供统一的加解密电路。项目组通过对 IoVCipher 进行基于轮架构的优化设计，验证了硬件实现的性能。图 5 中的电路是基于轮的架构，同时它支持加密和解密。IoVCipher 通过 Verilog 语言实现，由 Synopsys Design Compiler A-2007.12-SP1 合成，在标准单元库使用基于 UMC L180 0.18µm 1P6M logic process 的 UMCL18G212T3，进行硬件测试，结果如表 3 所示。

图 5 基于轮架构的 IoVCipher(加密+解密)
从表 3 可知，与 PRINCE、QARMA、Midori、SIMON 等相比，IoVCipher 的面积最小，能耗最低。一个 CAN 包传输的延迟是 0.8ms，而负载延迟开销应该是 0.1%(与传输延迟相比)。IoVCipher 的负载延迟也非常小，开销为 0.019%。当车辆以 120km/h 的速度行驶时，IoVCipher 有效载荷延迟产生的额外距离为 5m，这是一个可以接受的值。因此，从硬件性能结果来看，IoVCipher 是非常适合用于维护 CAN 总线数据帧安全的密码。
表 3 基于轮架构的不同密码实现结果(加密+解密)
密码 面积(GEs) 功耗(µW) 工艺库 有效负载加密延迟@100MHz 有效负载延迟开销
SIMON 1751 2.627 0.13µm 440 ns 0.055%
SPECK 2014 3.021 0.13µm 270ns 0.034%
PRESENT 5740 8.610 0.18µm 320 ns 0.04%
TWINE 2285 3.428 0.09µm 360 ns 0.045%
Midori 2033 3.050 0.18µm 160 ns 0.02%
PRINCE 3491 5.237 0.18µm 120 ns 0.015%
QARMA 7844 11.766 0.13µm 270 ns 0.034%
IoVCipher 1437 2.156 0.18µm 150 ns 0.019%
由于 IVLBC 是对合的，解密可以重用加密组件。然而，在统一加解密电路中，只需要少量的额外开销(只有交叉布线)来改变圆形函数操作的顺序。因此，项目组在 Verilog HDL 中实现了 IVLBC 基于轮的架构，如图 6 所示，并使用 ModelSim SE PLUS 6.6f 进行功能仿真。然后使用 synopsys 设计编译器 A-2007.12-SP1 在 UMC 的 0.18µm 中合成 IVLBC，图 7 为 IVLBC 加密 IP 核的内部连接图。

图 6 IVLBC 的基于轮架构实现

图 7 IVLBC 硬件电路的 RTL 图
表 4 给出了对合密码加解密模式实现结果的比较。结果表明，在资源极度受限的统一加解密电路中，IVLBC 具有更大的优势。由表 4-5 可以看出，IVLBC 所消耗的面积最小，能耗也较低。注意，为了保证公平的比较，表 4-5 中所有密码的硬件都是从头开始实现的，除了那些用星号标记的密码。此外，SKINNY、KLEIN、Midori 和 CRAFT 的硬件实现依赖于从 PEIGEN 平台获得的 S 盒硬件优化。
表 4 基于轮架构的不同密码实现结果(加密+解密)
尺寸 密码 延迟 面积
(GEs) 吞吐量
(Kbit/s) 能耗
()
64/80 PRESENT 31 2018 206.45 14.66
I-PRESENTTM 30 2467 213.3 17.35
Loong 20 2101 320 9.84
KLEIN 16 3150 400 11.81
PUFFIN2 34 2030 188.24 16.18
IVLBC 29 1447 220.69 9.83
64/128 PRINCE 10 3491 640 8.18
I-PRESENTTM 30 2783 213.33 19.57
Loong 32 2337 200 17.52
SKINNY 36 1812 177.78 15.29
Midori 16 2033 400 7.62
CRAFT 32 1835 200 13.76
IVLBC 29 1747 220.69 11.87
此外，项目组利用单片机, 车速传感器和 CAN 总线收发器等电子元器件，构建了一个实时速度采集加密平台，该平台在 CAN 总线系统环境中使用 IoVcipher 对交互的数据进行加密,使用 IVLBC 对存储的数据进行加密，如图 8 所示。该平台模拟 2 个 ECU：防抱死制动系统（ABS）、电子驻车制动系统（EPB）。IoVCipher 密码、IVLBC 密码（统一加解密模块）和 CAN 总线传输协议在该平台上实现。该平台选用两个 SJA1000 作为 CAN 总线控制器，连接在两个微控制器的中间，实现 CAN 总线通信。该演示的成功实施表明 IoVCipher 和 IVLBC 是可行的，这保证了车联网节点上数据的机密性，并为新兴智能网联汽车的第一道防线提供了解决方案。

图 8 实时速度采集加密平台

3·研究成果的科学意义和应用前景；学术界的反映和引用。
随着移动互联网和工业智能化的快速发展, 汽车产业不断向智能化和网联化快速转变，然而，车联网节点的资源受限设备中数据存储与信息交互并未加密，使得恶意攻击者可以轻易获取汽车行驶和个人隐私数据，进而操控汽车。因此，车联网节点数据安全维护刻不容缓。由于车辆电子控制单元受实时性、计算能力、功耗和存储等许多新因素限制，而无法使用传统加密算法。轻量级密码算法由于具有计算速度快、占用面积小等特点，成为了智能网联汽车这种新计算模式数据安全维护的新方案。
本项目针对车联网节点受限设备的数据安全维护，设计了专门的轻量级分组密码。具体来说，针对实时的信息交互，设计了一种低延迟的动态轻量级密码 IoVCipher；针对终端的存储模块，设计了一种对合且高扩散的轻量级密码 IVLBC。项目组成员对轻量级密码算法进行了安全性分析、硬件设计与实现，并搭建了汽车速度采集加密传输平台，用于验证设计的轻量级分组密码的可行性。实验结果显示，IoVCipher 和 IVLBC 在车联网节点的底层受限设备中具有良好的硬件性能以及很高的安全性，具有较好的应用前景。
本项目成员撰写的论文《IVLBC: An Involutive Lightweight Block Cipher for Internet of Things》被中科院 SCI 二区期刊 IEEE Internet of Things Journal 录用发表。撰写的论文《IoVCipher：A Low-Latency Dynamic Lightweight Block Cipher for Internet of Vehicles》已投稿至 SCI 二区期刊 Journal of Systems Architecture，撰写的 2 项发明专利一项已授权，一项进入实质审查期。IVLBC、IoVCipher 专门针对车联网节点安全需求进行设计，这对于密码分析学和密码编码学的研究与发展都有很好的推动作用。

4·与申请书的预期研究进展和成果比较，存在哪些问题，说明原因。
本项目是 2022 年 5 月经湖南省教育厅批准立项的研究生科技创新项目。根据批准的项目申请书，项目成员按计划完成了项目研究，研究成果符合预期。

5·与项目负责人的学位论文有关的研究工作及成果。
项目负责人为研究生二年级学生，于 2022 年 11 月进行了硕士学位论文开题报告，学位论文选题是在已有的轻量级分组密码算法上拓展研究的课题。
（1）一方面，项目负责人对车联网节点的安全需求进行了较为详尽的调研，确立面向车联网节点的轻量级分组密码的设计目标，其中设计目标重点考虑低延迟、低面积、高扩散等指标。另一方面，项目负责人考察现有轻量级分组密码算法的设计特点和可能存在的安全弱点。在上述研究基础上，项目负责人面向车联网节点的底层受限设备，设计了轻量级分组密码保护方案，分别为具有低延迟的 IoVCipher 密码、具有对合特性的 IVLBC 密码。
（2）为了设计一种具有低延迟、低功耗的轻量级密码来保护实时信息交互中 CAN 总线数据帧的安全，项目负责人从密码算法结构入手，设计了一种动态加密结构，使 IoVCipher 在不同加密芯片的加密流程中存在细微差异来防止一些针对静态结构恢复密钥的攻击。另外，关键组件围绕低延迟进行设计，基于门级电路构造了一个轻量、低延迟密码性质良好的 S 盒，并设计了一种低延迟的密钥编排方法，做到不需要消耗额外的密钥状态寄存器的同时，还能有效抵御滑动攻击。
（3）为了设计一种对合且高扩散的 SPN 结构轻量级密码 IVLBC 来保护终端数据存储安全。首先，项目负责人从密码算法结构入手，设计了一种全部组件对合的结构，使解密电路能完全复用加密电路。其次，提出了一种对合的轻量级 S 盒构造方法，利用遗传算法对一类 S 盒进行筛选来获得一个对合、紧凑、低功率且密码性质良好的 S 盒。另外，提出了一种基于半字节的对合、高扩散 P 置换构造方法，使 IVLBC 在第 4 轮能达到雪崩效应。
（4）为了测试轻量级密码算法具有的安全性能，项目负责人对轻量级密码算法进行了差分攻击、线性攻击、积分攻击、代数攻击、中间相遇攻击、滑动攻击、相关密钥攻击和不变攻击等安全性分析。测试结果显示，轻量级密码算法能抵抗一些常见攻击手段。
（5）为了验证 IoVCipher 密码、IVLBC 密码在车联网中的可行性，项目负责人基于轮架构对轻量级密码算法进行硬件电路设计，运用 Verilog HDL 语言实现轻量级密码算法对数据的加解密操作，进一步在 ASIC 的开发环境中，利用 Synopsys Design Compiler 软件工具进行硬件性能测试和时序仿真，验证模块功能的正确性。最后，在测试功能完整后，利用 MCU，车速传感器和 CAN 总线收发器等电子元器件，搭建了汽车速度采集加密传输平台，验证设计的轻量级分组密码的可行性。

6·经费使用情况。
（1）实验耗材费用 1200 元
本部分经费用于购买相关实验设备以及资料打印与复印。
（2）差旅费用 1800 元
本部分经费用于参加学术交流讨论会议。
（3）发明专利申请费用 5000 元
本项目申请发明专利 2 篇，本部分经费用于专利申请费用。
（4）论文发表费用 2000 元
本项目发表论文 1 篇，本部分经费用于论文版面费
